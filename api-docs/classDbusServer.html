<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCPN Partial API docs: DbusServer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenCPN Partial API docs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classDbusServer.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classDbusServer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">DbusServer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Basic interface to low-level DBus library.  
 <a href="classDbusServer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="dbus__server_8h_source.html">dbus_server.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for DbusServer:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classDbusServer.png" usemap="#DbusServer_map" alt=""/>
  <map id="DbusServer_map" name="DbusServer_map">
<area href="classLocalServerApi.html" title="Base interface for local server command handling." alt="LocalServerApi" shape="rect" coords="0,0,101,24"/>
<area href="classInstanceCheck.html" title="Common interface for all instance checkers." alt="InstanceCheck" shape="rect" coords="111,0,212,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4b11677c4f865f4e735f7aacb0a02527"><td class="memItemLeft" align="right" valign="top"><a id="a4b11677c4f865f4e735f7aacb0a02527"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>DbusServer</b> (<a class="el" href="classDbusServer.html">DbusServer</a> &amp;)=delete</td></tr>
<tr class="separator:a4b11677c4f865f4e735f7aacb0a02527"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa79c98ddfa913d7b06b673b1d67573d0"><td class="memItemLeft" align="right" valign="top"><a id="aa79c98ddfa913d7b06b673b1d67573d0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classDbusServer.html">DbusServer</a> &amp;)=delete</td></tr>
<tr class="separator:aa79c98ddfa913d7b06b673b1d67573d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b8e05de972f914e817fb958e8764209"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDbusServer.html#a9b8e05de972f914e817fb958e8764209">WaitUntilValid</a> () override</td></tr>
<tr class="memdesc:a9b8e05de972f914e817fb958e8764209"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait until ready.  <a href="classDbusServer.html#a9b8e05de972f914e817fb958e8764209">More...</a><br /></td></tr>
<tr class="separator:a9b8e05de972f914e817fb958e8764209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa379f79d88913d6152f53323a2e51b0f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDbusServer.html#aa379f79d88913d6152f53323a2e51b0f">IsMainInstance</a> ()</td></tr>
<tr class="memdesc:aa379f79d88913d6152f53323a2e51b0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if this instance is the only one.  <a href="classDbusServer.html#aa379f79d88913d6152f53323a2e51b0f">More...</a><br /></td></tr>
<tr class="separator:aa379f79d88913d6152f53323a2e51b0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2ae970cbce1f3c95d424d6fe121c770"><td class="memItemLeft" align="right" valign="top"><a id="ac2ae970cbce1f3c95d424d6fe121c770"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>SetMainInstance</b> (bool value)</td></tr>
<tr class="separator:ac2ae970cbce1f3c95d424d6fe121c770"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfc97881a232bc460b0394256dc7b19a"><td class="memItemLeft" align="right" valign="top"><a id="adfc97881a232bc460b0394256dc7b19a"></a>
<a class="el" href="classDbusServer.html">DbusServer</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>UnitTestInstance</b> ()</td></tr>
<tr class="separator:adfc97881a232bc460b0394256dc7b19a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classLocalServerApi"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classLocalServerApi')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classLocalServerApi.html">LocalServerApi</a></td></tr>
<tr class="memitem:a2a78fa4f00988073ac5d041378aa64c4 inherit pub_methods_classLocalServerApi"><td class="memItemLeft" align="right" valign="top"><a id="a2a78fa4f00988073ac5d041378aa64c4"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalServerApi.html#a2a78fa4f00988073ac5d041378aa64c4">SetGetRestApiEndpointCb</a> (std::function&lt; std::string()&gt; cb)</td></tr>
<tr class="memdesc:a2a78fa4f00988073ac5d041378aa64c4 inherit pub_methods_classLocalServerApi"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set callback returning the rest server root endpoint. <br /></td></tr>
<tr class="separator:a2a78fa4f00988073ac5d041378aa64c4 inherit pub_methods_classLocalServerApi"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classInstanceCheck"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classInstanceCheck')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classInstanceCheck.html">InstanceCheck</a></td></tr>
<tr class="memitem:a62692d5df288fa916b95c305de703590 inherit pub_methods_classInstanceCheck"><td class="memItemLeft" align="right" valign="top"><a id="a62692d5df288fa916b95c305de703590"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classInstanceCheck.html#a62692d5df288fa916b95c305de703590">CleanUp</a> ()</td></tr>
<tr class="memdesc:a62692d5df288fa916b95c305de703590 inherit pub_methods_classInstanceCheck"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove all persistent instance state, including possible lock file and defunct opencpn processes. <br /></td></tr>
<tr class="separator:a62692d5df288fa916b95c305de703590 inherit pub_methods_classInstanceCheck"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1dcc96fdbe29f14ff3b3f7e7854118e inherit pub_methods_classInstanceCheck"><td class="memItemLeft" align="right" valign="top"><a id="ad1dcc96fdbe29f14ff3b3f7e7854118e"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classInstanceCheck.html#ad1dcc96fdbe29f14ff3b3f7e7854118e">OnExit</a> ()</td></tr>
<tr class="memdesc:ad1dcc96fdbe29f14ff3b3f7e7854118e inherit pub_methods_classInstanceCheck"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do whatever needed before wxWidget's checks triggers. <br /></td></tr>
<tr class="separator:ad1dcc96fdbe29f14ff3b3f7e7854118e inherit pub_methods_classInstanceCheck"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a4eb3b290c4b90cd3f40a53671f0d1b43"><td class="memItemLeft" align="right" valign="top"><a id="a4eb3b290c4b90cd3f40a53671f0d1b43"></a>
static <a class="el" href="classDbusServer.html">DbusServer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>GetInstance</b> ()</td></tr>
<tr class="separator:a4eb3b290c4b90cd3f40a53671f0d1b43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7159878d1b46bf37bddf146539d33053"><td class="memItemLeft" align="right" valign="top"><a id="a7159878d1b46bf37bddf146539d33053"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDbusServer.html#a7159878d1b46bf37bddf146539d33053">Disconnect</a> ()</td></tr>
<tr class="memdesc:a7159878d1b46bf37bddf146539d33053"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear current singleton instance and disconnect from session bus. <br /></td></tr>
<tr class="separator:a7159878d1b46bf37bddf146539d33053"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classLocalServerApi"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classLocalServerApi')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classLocalServerApi.html">LocalServerApi</a></td></tr>
<tr class="memitem:a99e4208d2e7dfadcb6a66b71e1846d2a inherit pub_static_methods_classLocalServerApi"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classLocalServerApi.html">LocalServerApi</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalServerApi.html#a99e4208d2e7dfadcb6a66b71e1846d2a">GetInstance</a> ()</td></tr>
<tr class="separator:a99e4208d2e7dfadcb6a66b71e1846d2a inherit pub_static_methods_classLocalServerApi"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classInstanceCheck"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classInstanceCheck')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classInstanceCheck.html">InstanceCheck</a></td></tr>
<tr class="memitem:a0a28eac18abb3e5537a45a37c590a44c inherit pub_static_methods_classInstanceCheck"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classInstanceCheck.html">InstanceCheck</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classInstanceCheck.html#a0a28eac18abb3e5537a45a37c590a44c">GetInstance</a> ()</td></tr>
<tr class="separator:a0a28eac18abb3e5537a45a37c590a44c inherit pub_static_methods_classInstanceCheck"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a48eef3010d328378d7141acbfdaacb50"><td class="memItemLeft" align="right" valign="top"><a id="a48eef3010d328378d7141acbfdaacb50"></a>
GDBusNodeInfo *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDbusServer.html#a48eef3010d328378d7141acbfdaacb50">introspection_data</a></td></tr>
<tr class="memdesc:a48eef3010d328378d7141acbfdaacb50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback context. <br /></td></tr>
<tr class="separator:a48eef3010d328378d7141acbfdaacb50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_classLocalServerApi"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classLocalServerApi')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classLocalServerApi.html">LocalServerApi</a></td></tr>
<tr class="memitem:a51195d64940c48780dc48152ca9e143b inherit pub_attribs_classLocalServerApi"><td class="memItemLeft" align="right" valign="top"><a id="a51195d64940c48780dc48152ca9e143b"></a>
<a class="el" href="classEventVar.html">EventVar</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalServerApi.html#a51195d64940c48780dc48152ca9e143b">on_raise</a></td></tr>
<tr class="memdesc:a51195d64940c48780dc48152ca9e143b inherit pub_attribs_classLocalServerApi"><td class="mdescLeft">&#160;</td><td class="mdescRight">Notified on the Raise command. <br /></td></tr>
<tr class="separator:a51195d64940c48780dc48152ca9e143b inherit pub_attribs_classLocalServerApi"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67a015ef3791cd12cac29fa7a0d15590 inherit pub_attribs_classLocalServerApi"><td class="memItemLeft" align="right" valign="top"><a id="a67a015ef3791cd12cac29fa7a0d15590"></a>
<a class="el" href="classEventVar.html">EventVar</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalServerApi.html#a67a015ef3791cd12cac29fa7a0d15590">on_quit</a></td></tr>
<tr class="memdesc:a67a015ef3791cd12cac29fa7a0d15590 inherit pub_attribs_classLocalServerApi"><td class="mdescLeft">&#160;</td><td class="mdescRight">Notified on the Quit command. <br /></td></tr>
<tr class="separator:a67a015ef3791cd12cac29fa7a0d15590 inherit pub_attribs_classLocalServerApi"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14dba8337839994983c83fd663536698 inherit pub_attribs_classLocalServerApi"><td class="memItemLeft" align="right" valign="top"><a id="a14dba8337839994983c83fd663536698"></a>
std::function&lt; bool(const std::string &amp;)&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalServerApi.html#a14dba8337839994983c83fd663536698">open_file_cb</a></td></tr>
<tr class="memdesc:a14dba8337839994983c83fd663536698 inherit pub_attribs_classLocalServerApi"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback invoked on open command with a file path argument. <br /></td></tr>
<tr class="separator:a14dba8337839994983c83fd663536698 inherit pub_attribs_classLocalServerApi"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a613498ce9215e6bc720513bcf089a4d6 inherit pub_attribs_classLocalServerApi"><td class="memItemLeft" align="right" valign="top"><a id="a613498ce9215e6bc720513bcf089a4d6"></a>
std::function&lt; std::string()&gt;&#160;</td><td class="memItemRight" valign="bottom"><b>get_rest_api_endpoint_cb</b></td></tr>
<tr class="separator:a613498ce9215e6bc720513bcf089a4d6 inherit pub_attribs_classLocalServerApi"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Basic interface to low-level DBus library. </p>
<p>The server is started by the first call to GetInstance(). The server bith acts as a regular LocalApiServer and as an InstanceCheckinstance check. </p>

<p class="definition">Definition at line <a class="el" href="dbus__server_8h_source.html#l00094">94</a> of file <a class="el" href="dbus__server_8h_source.html">dbus_server.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="aa379f79d88913d6152f53323a2e51b0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa379f79d88913d6152f53323a2e51b0f">&#9670;&nbsp;</a></span>IsMainInstance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool DbusServer::IsMainInstance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if this instance is the only one. </p>
<dl class="section return"><dt>Returns</dt><dd>true if ctor was able to claim kDbusName, else false. </dd></dl>

<p>Implements <a class="el" href="classInstanceCheck.html#a0d9134c227014f323385b4f10057c44f">InstanceCheck</a>.</p>

<p class="definition">Definition at line <a class="el" href="dbus__server_8h_source.html#l00129">129</a> of file <a class="el" href="dbus__server_8h_source.html">dbus_server.h</a>.</p>

</div>
</div>
<a id="a9b8e05de972f914e817fb958e8764209"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b8e05de972f914e817fb958e8764209">&#9670;&nbsp;</a></span>WaitUntilValid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DbusServer::WaitUntilValid </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Wait until ready. </p>
<p>There is no signal for "ready", so the strategy is to just wait for some time, allowing the underlying layers to perform the dbus handshake. If we have claimed the bus name after this time we are a server, else a client.</p>
<p>TODO: Some clever algorithm to define processor speed which could be used to determine the wait time. On my fast development machine 200 us is enough in native Linux, but Flatpak requires longer time.</p>
<p>TODO: Some kind of lazy evalution to avoid delays? </p>

<p>Reimplemented from <a class="el" href="classInstanceCheck.html#af104f6db1d4fc155baeb7a578551cd71">InstanceCheck</a>.</p>

<p class="definition">Definition at line <a class="el" href="dbus__server_8cpp_source.html#l00154">154</a> of file <a class="el" href="dbus__server_8cpp_source.html">dbus_server.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/OpenCPN/OpenCPN/model/include/model/<a class="el" href="dbus__server_8h_source.html">dbus_server.h</a></li>
<li>/home/runner/work/OpenCPN/OpenCPN/model/src/<a class="el" href="dbus__server_8cpp_source.html">dbus_server.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classDbusServer.html">DbusServer</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
